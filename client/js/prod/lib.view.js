window.SLB&&SLB.attach&&(l=>{var h={assets:{},component_defaults:[],loading:[],cache:{},component_temps:{},options:{},_init:function(){this._super(),this.init_refs(),this.init_components()},init_refs:function(){var t,e,i;for(i in this)if(i=this[i],this.is_component(i)&&!this.util.is_empty(i.prototype._refs))for(t in i.prototype._refs)e=i.prototype._refs[t],this.util.is_string(e)&&e in this&&(e=i.prototype._refs[t]=this[e]),this.util.is_class(e)||delete i.prototype_refs[t]},init_components:function(){this.component_defaults=[this.Viewer]},init:function(t){var i=this;l.when.apply(l,this.loading).always(function(){l.extend(!0,i.options,t),l(window).on("popstate",function(t){var e=t.originalEvent.state;if(i.util.in_obj(e,["item","viewer"]))return i.get_viewer(e.viewer).history_handle(t),t.preventDefault()}),i.init_items()})},can_make_default_component:function(t){return-1!==l.inArray(t,this.component_defaults)},is_component:function(t){return this.util.is_class(t,this.Component)},get_components:function(t){var e={};return this.is_component(t)&&((t=t.prototype._slug+"s")in this.cache||(this.cache[t]={}),e=this.cache[t]),e},get_component:function(t,e){var i,s,n=null;return n=this.util.is_func(t)&&(this.util.is_string(e)||(e=null),i=this.get_components(t),this.util.is_obj(i)&&(s=this.util.is_string(e)?e:this.util.add_prefix("default"))in i&&(n=i[s]),this.util.is_empty(n))&&(this.util.is_string(e)||this.can_make_default_component(t))?this.add_component(t,e):n},add_component:function(t,e,i){if(!this.util.is_func(t))return!1;if(this.util.is_empty(e)&&!this.can_make_default_component(t))return!1;var s=null,n=(this.util.is_empty(e)&&(e=this.util.add_prefix("default")),this.util.is_obj(i)||(i={}),"component"!==t.prototype._slug?"add_"+t.prototype._slug:null),s=!this.util.is_empty(n)&&n in this&&this.util.is_func(this[n])?this[n](e,i):new t(e,i);if(this.util.is_type(s,t)){var r=this.get_components(t);switch(l.type(r)){case"object":r[e]=s;break;case"array":r.push(s)}}else s=null;return s},add_component_temp:function(t){var e=null;return this.is_component(t)&&(e=new t(""),this.component_temps[e._slug]=e),e},get_component_temp:function(t){return this.has_component_temp(t)?this.component_temps[t.prototype._slug]:this.add_component_temp(t)},has_component_temp:function(t){return!!(this.is_component(t)&&t.prototype._slug in this.component_temps)},get_options:function(t){var e={};if(this.util.is_string(t)&&(t=[t]),this.util.is_array(t))for(var i=0;i<t.length;i++)t[i]in this.options&&(e[t[i]]=this.options[t[i]]);return e},get_option:function(t,e){var i=this.get_options(t);return i=this.util.is_obj(i)&&t in i?i[t]:this.util.is_set(e)?e:null},add_viewer:function(t,e){t=new this.Viewer(t,e);return this.get_viewers()[t.get_id()]=t},get_viewers:function(){return this.get_components(this.Viewer)},has_viewer:function(t){return!!(this.util.is_string(t)&&t in this.get_viewers())},get_viewer:function(t){return this.has_viewer(t)||(t=this.util.add_prefix("default"),this.has_viewer(t))||(t=(t=this.add_viewer(t)).get_id()),this.get_viewers()[t]},init_items:function(){var e=this,t=this.util.format('a[href][%s="%s"]',this.util.get_attribute("active"),1);l(document).on("click",t,null,function(){var t=e.show_item(this);return!(t=e.util.is_bool(t)?t:!0)})},get_items:function(){return this.get_components(this.Content_Item)},get_item:function(t){var e,i;return this.util.is_type(t,this.Content_Item)?t:(e=null,this.util.in_obj(t,"nodeType")?(i=this.get_component_temp(this.Content_Item).get_data_key(),e=l(t).data(i)):this.util.is_string(t,!1)&&t in(i=this.get_items())&&(e=i[t]),this.util.is_instance(e,this.Content_Item)?e:this.add_item(t))},add_item:function(t){return new this.Content_Item(t)},show_item:function(t){return this.get_item(t).show()},save_item:function(t){return this.util.is_instance(t,this.Content_Item)&&(this.get_items()[t.get_id()]=t),t},get_content_handlers:function(){return this.get_components(this.Content_Handler)},get_content_handler:function(t){var t=this.util.is_instance(t,this.Content_Item)?t.get_attribute("type",""):t.toString(),e=this.get_content_handlers();return t in e?e[t]:null},extend_content_handler:function(t,e){var i=null;return this.util.is_string(t)&&this.util.is_obj(e)&&(null===(i=this.get_content_handler(t))?this.get_content_handlers()[t]=i=new this.Content_Handler(t,e):i.set_attributes(e),this.util.in_obj(e,"styles"))&&this.load_styles(e.styles),i},add_group:function(t,e){return t=new this.Group(t,e),this.get_groups()[t.get_id()]=t},get_groups:function(){return this.get_components(this.Group)},get_group:function(t){return this.has_group(t)?this.get_groups()[t]:this.add_group(t)},has_group:function(t){return this.util.is_string(t)&&t in this.get_groups()},extend_theme:function(t,e){var i,s;return!!this.util.is_string(t)&&(i=l.Deferred(),this.loading.push(i),s=this.get_theme_model(t),this.util.is_empty(s)&&(s=this.save_theme_model({parent:null,id:t})),this.util.is_obj(e)&&("id"in e&&delete e.id,l.extend(s,e)),this.util.in_obj(e,"styles")&&this.load_styles(e.styles),this.util.is_obj(s.parent)||(s.parent=this.get_theme_model(s.parent)),i.resolve(),s)},get_theme_models:function(){return this.Theme.prototype._models},get_theme_model:function(t){var e=this.get_theme_models();return this.util.in_obj(e,t)?e[t]:{}},save_theme_model:function(t){return this.util.in_obj(t,"id")&&this.util.is_string(t.id)&&(this.get_theme_models()[t.id]=t),t},extend_template_tag_handler:function(t,e){var i,s;return!(!this.util.is_string(t)||!this.util.is_obj(e))&&(s=this.get_template_tag_handlers(),this.util.in_obj(s,t)?(i=s[t]).set_attributes(e):s[(i=new this.Template_Tag_Handler(t,e)).get_id()]=i,this.util.in_obj(e,"styles")&&this.load_styles(e.styles),this.util.in_obj(e,"_hooks")&&e._hooks.call(i),i)},get_template_tag_handlers:function(){return this.Template_Tag.prototype.handlers},get_template_tag_handler:function(t){var e=this.get_template_tag_handlers();return this.util.in_obj(e,t)?e[t]:null},load_styles:function(t){if(this.util.is_array(t)){for(var e,i=[],s=0;s<t.length;s++)this.util.in_obj(e=t[s],"uri")&&this.util.is_string(e.uri)&&i.push('<link rel="stylesheet" type="text/css" href="'+e.uri+'" />');l("head").append(i.join(""))}}},t={_slug:"component",_ns:null,_refs:{},_reciprocal:!1,_dom:null,_attributes:!1,_attr_default:{},_attr_default_parsed:!1,_attr_init:null,_attr_map:{},_events:{},_status:null,_id:"",_c:function(t,e){this._set_id(t),this.util.is_obj(e)&&(this._attr_init=e),this._hooks()},_set_parent:function(){this._super(h)},_hooks:function(){},_set_id:function(t){return this.util.is_empty(this._id)&&(this._id=this.util.is_string(t)?t:this.util.guid()),this._id},get_id:function(t){var e=this._id;return e=this.util.is_bool(t)&&t?this.add_ns(e):e},get_ns:function(){return null===this._ns&&(this._ns=this.util.add_prefix(this._slug)),this._ns},add_ns:function(t){return this.util.is_string(t)?this.get_ns()+"_"+t:""},get_status:function(t,e){var i=!1;return i=this.util.in_obj(this._status,t)?e?this._status[t]:!!this._status[t]:i},set_status:function(t,e){return this.util.is_string(t)?(this.util.is_set(e)||(e=!0),this.util.is_obj(this._status,!1)||(this._status={}),this._status[t]=e):this.util.is_set(e)||(e=!1),e},get_controller:function(){return this.get_parent()},has_reference:function(t){return!!(this.util.is_string(t)&&t in this&&t in this.get_references())},get_references:function(){return this._refs},get_reference:function(t){return this.has_reference(t)?this._refs[t]:null},get_component:function(t,e){var i=null;if(this.has_reference(t)){e=l.extend({},{check_attr:!0,get_default:!1},e);var s=this.get_reference(t);if(this.util.is_type(this[t],s))return this[t];i=this[t]=null,e.check_attr&&(i=this.get_attribute(t),this.util.is_empty(i)||(i=this.set_component(t,i))),this.util.is_empty(i)&&e.get_default&&(i=this.get_controller().get_component(s))}return i},set_component:function(t,e,i){var s;return this.has_reference(t)?((this.util.is_empty(e)||(s=this.get_reference(t),this.util.is_string(e,!1)&&(e=this.get_controller().get_component(s,e)),!this.util.is_type(e,s))||this.util.is_func(i)&&!i.call(this,e))&&(e=null),this[t]=e,this[t]):null},clear_component:function(t){this.set_component(t,null)},init_attributes:function(t){!(t=this.util.is_bool(t)?t:!1)&&this.util.is_obj(this._attributes)||(t=this._attributes={},l.extend(t,this.init_default_attributes()),this.util.is_obj(this._attr_init)&&l.extend(t,this._attr_init),l.extend(t,this.get_dom_attributes()))},init_default_attributes:function(){if(!this._attr_default_parsed&&this.util.is_obj(this._attr_map)){var t=this.get_controller().get_options(this.util.obj_keys(this._attr_map));if(this.util.is_obj(t)){for(var e in this._attr_map)e in t&&null!==this._attr_map[e]&&(t[this._attr_map[e]]=t[e],delete t[e]);l.extend(!0,this._attr_default,t)}this._attr_default_parsed=!0}return this._attr_default},get_dom_attributes:function(){var s={},t=this.dom_get(null,{init:!1});if(0<t.length){t=l(t).get(0).attributes;if(this.util.is_obj(t)){var n,r=this.util.get_attribute();let i=this;l.each(t,function(t,e){if(-1===e.name.indexOf(r))return!0;n=e.name.substr(r.length+1),s[n]=i.util.esc_html(e.value)})}}return s},get_attributes:function(){return this.init_attributes(),this._attributes},get_attribute:function(t,e,i){if(this.util.is_set(e)||(e=null),!this.util.is_string(t))return e;this.util.is_bool(i)||(i=!0);t=this.has_attribute(t)?this.get_attributes()[t]:e;return i&&t!==e&&null!==e&&!this.util.is_type(t,l.type(e),!1)&&(this.util.is_scalar(e,!1)&&this.util.is_scalar(t,!1)?this.util.is_string(e,!1)?t=t.toString():this.util.is_num(e,!1)&&!this.util.is_num(t,!1)?(t=(this.util.is_int(e,!1)?parseInt:parseFloat)(t),this.util.is_num(t,!1)||(t=e)):t=this.util.is_bool(e,!1)?this.util.is_string(t)||this.util.is_num(t):e:t=e),t},call_attribute:function(t,e){return t=this.get_attribute(t),this.util.is_func(t)&&(e=Array.prototype.slice.call(arguments,1),t=t.apply(this,e)),t},has_attribute:function(t){return this.util.is_string(t)&&t in this.get_attributes()},set_attributes:function(t,e){this.util.is_bool(e)||(e=!1),this.init_attributes(e),this.util.is_obj(t)&&l.extend(this._attributes,t)},set_attribute:function(t,e){return this.util.is_string(t)&&this.util.is_set(e)&&(this.get_attributes()[t]=e),e},dom_get_selector:function(t){return this.util.is_string(t)?"."+this.add_ns(t):""},dom_get_attribute:function(){return this.util.get_attribute(this._slug)},dom_set:function(t){return(t=l(t)).data(this.get_data_key(),this),this._reciprocal&&(this._dom=t),t},dom_get:function(t,e){var i,s={init:!0,put:!1},s=((e=this.util.is_obj(e)?l.extend({},s,e):s).init&&!this.get_status("dom_init")&&(this.set_status("dom_init"),this.dom_init()),this._dom);return s&&this.util.is_string(t)&&((i=l(s).find(this.dom_get_selector(t))).length?s=i:!0!==e.put&&!this.util.is_obj(e.put)||(s=this.dom_put(t,e.put))),l(s)},dom_init:function(){},dom_put:function(t,e){var i=null;if(this.dom_has()&&this.util.is_string(t)){for(var s=["tag","content","success"],n={tag:"div",content:"",class:this.add_ns(t)},r=(this.util.is_empty(e)||(this.util.is_type(e,jQuery,!1)||this.util.is_string(e,!1)?n.content=e:this.util.is_obj(e,!1)&&l.extend(n,e)),l.extend({},n)),_=0;_<s.length;_++)delete r[s[_]];e=this.dom_get();(i=l(this.dom_get_selector(t),e)).length||(i=l(this.util.format("<%s />",n.tag),r).appendTo(e)).length&&this.util.is_method(n,"success")&&n.success.call(i,i),l(i).append(n.content)}return l(i)},dom_has:function(){return!!this.dom_get().length},get_data_key:function(){return this.get_ns()},on:function(t,e,i){var s,n,r;return this.util.is_string(t)&&this.util.is_func(e)?(this.util.is_obj(i,!1)||(i={}),i=l.extend({},{clear:!1},i),this.util.is_obj(this._events,!1)||(this._events={}),t in(r=this._events)&&this.util.is_obj(r[t],!1)&&!i.clear||(r[t]=[]),r[t].push(e)):(s=this,n=Array.prototype.slice.call(arguments,1),this.util.is_array(t)?l.each(t,function(t,e){s.on.apply(s,[e].concat(n))}):this.util.is_obj(t)&&l.each(t,function(t,e){s.on.apply(s,[t,e].concat(n))})),this},trigger:function(t,i){var s,e=l.Deferred(),n=[],r=this;return this.util.is_array(t)?(l.each(t,function(t,e){n.push(r.trigger(e,i))}),l.when.apply(r,n).done(function(){e.resolve()})):this.util.is_string(t)&&t in this._events?(s={type:t,data:null},this.util.is_set(i)&&(s.data=i),l.each(this._events[t],function(t,e){n.push(e.call(r,s,r))}),l.when.apply(this,n).done(function(){e.resolve()})):e.resolve(),e.promise()}},e=(h.Component=t=SLB.Class.extend(t),{_slug:"viewer",_refs:{item:"Content_Item",theme:"Theme"},_reciprocal:!0,_attr_default:{loop:!0,animate:!0,autofit:!0,overlay_enabled:!0,overlay_opacity:"0.8",title_default:!1,container:null,slideshow_enabled:!0,slideshow_autostart:!1,slideshow_duration:2,slideshow_active:!1,slideshow_timer:null,labels:{close:"close",nav_prev:"&laquo; prev",nav_next:"next &raquo;",slideshow_start:"start slideshow",slideshow_stop:"stop slideshow",group_status:"Image %current% of %total%",loading:"loading"}},_attr_map:{theme:null,group_loop:"loop",ui_autofit:"autofit",ui_animate:"animate",ui_overlay_opacity:"overlay_opacity",ui_labels:"labels",ui_title_default:"title_default",slideshow_enabled:null,slideshow_autostart:null,slideshow_duration:null},item:null,item_queued:null,theme:null,item_working:null,active:!1,init:!1,open:!1,loading:!1,_hooks:function(){var t=this;this.on(["item-prev","item-next"],function(){t.trigger("item-change")}).on(["close","item-change"],function(){t.unload().done(function(){t.unlock()})})},get_item:function(){return this.get_component("item")},set_item:function(t){this.clear_item(!1);t=this.set_component("item",t,function(t){return t.has_type()});return!this.util.is_empty(t)},clear_item:function(t){this.util.is_bool(t)||(t=!0);var e=this.get_item();e&&e.reset(),t&&this.clear_component("item")},get_theme:function(){var t=this.get_component("theme",{check_attr:!1});return t=this.util.is_empty(t)?this.set_component("theme",new h.Theme(this)):t},set_theme:function(t){this.set_component("theme",t)},lock:function(){return this.set_status("item_working",l.Deferred())},get_lock:function(t,e){this.util.is_bool(t)||(t=!1),this.util.is_bool(e)||(e=!1);var i="item_working";return t?this.get_status(i):(t=this.get_status(i,!0),this.util.is_promise(t)||(t=this.lock()),e?t:t.promise())},is_locked:function(){return this.get_lock(!0)},unlock:function(){return this.get_lock(!1,!0).resolve()},set_active:function(t){return this.util.is_bool(t)||(t=!0),this.set_status("active",t)},is_active:function(){return this.get_status("active")},set_loading:function(t){var e=l.Deferred(),i=(this.util.is_bool(t)||(t=!0),this.loading=t,this.slideshow_active()&&this.slideshow_pause(t),t?"addClass":"removeClass");return l(this.dom_get())[i]("loading"),t?this.get_theme().transition("load").always(function(){e.resolve()}):e.resolve(),e.promise()},unset_loading:function(){return this.set_loading(!1)},get_loading:function(){return!!this.util.is_bool(this.loading)&&this.loading},is_loading:function(){return this.get_loading()},show:function(t){this.item_queued=t;var e="show_deferred",t="theme_valid",i=!0;if(this.has_attribute(t)?i=this.get_attribute(t,!0):(i=!(!this.get_theme()||""===this.get_theme().get_template().get_layout(!1)),this.set_attribute(t,i)),!i)return this.close(),!1;function s(){if(n.lock(),n.set_status(e,!1),!n.set_item(n.item_queued))return n.close();n.history_add(),n.set_active(),n.render()}var n=this;this.is_locked()?this.get_status(e)||(this.set_status(e),this.get_lock().always(function(){s()})):s()},history_handle:function(t){var e=t.originalEvent.state;this.util.is_string(e.item,!1)?(this.get_controller().get_item(e.item).show({event:t}),this.trigger("item-change")):(e=this.history_get(!0),this.history_set(0),-1!==e&&this.close())},history_get:function(t){return this.get_status("history_count",t)},history_set:function(t){return this.set_status("history_count",t)},history_add:function(){if(!history.pushState)return!1;var t=this.get_item(),e=t.get_attribute("options_show"),i=this.history_get()?this.history_get(!0):0;this.util.in_obj(e,"event")?(e=e.event.originalEvent,this.util.in_obj(e,"state")&&this.util.in_obj(e.state,"count")&&(i=e.state.count)):(e={viewer:this.get_id(),item:null,count:i},i||history.replaceState(e,null),e.item=this.get_controller().save_item(t).get_id(),e.count=++i,history.pushState(e,"")),this.history_set(i)},history_reset:function(){var t=this.history_get(!0);t&&(this.history_set(-1),history.go(-1*t))},is_open:function(){return"none"!==this.dom_get().css("display")},render:function(){var r=this,t=this.get_theme();r.dom_prep(),this.get_status("render-events")||(this.set_status("render-events"),t.on("render-loading",function(t,e){var i,s,n=l.Deferred();return r.is_active()?(i=function(){r.dom_get().css("top",l(window).scrollTop())},s=function(){r.set_loading().always(function(){n.resolve()})},r.is_open()?e.transition("unload").fail(function(){i(),e.dom_get_tag("item","content").attr("style","")}).always(s):e.transition("open").always(function(){s(),r.events_open(),r.open=!0}).fail(function(){i(),r.get_overlay().show(),r.dom_get().show()})):n.reject(),n.promise()}).on("render-complete",function(t,e){if(!r.is_active())return!1;var i=r.dom_get(),s=["item_single","item_multi"],n=["addClass","removeClass"];r.get_item().get_group().is_single()||n.reverse(),l.each(n,function(t,e){i[e](s[t])}),r.events_complete(),e.transition("complete").fail(function(){var t;r.get_attribute("autofit",!0)&&(t=l.extend({display:"inline-block"},e.get_item_dimensions()),e.dom_get_tag("item","content").css(t))}).always(function(){r.unset_loading(),r.trigger("render-complete"),r.init=!0})})),t.render()},dom_get_container:function(){var t=this.get_attribute("container"),e=(this.util.is_empty(t)&&(t="#"+this.add_ns("wrap")),l(t));return e.length||(t=0===t.indexOf("#")?t.substr(1):t,e=l("<div />",{id:t}).appendTo("body")),e},dom_init:function(){var t=this.dom_set(l("<div/>",{id:this.get_id(!0),class:this.get_ns()})).appendTo(this.dom_get_container()).hide(),e=this.get_theme(),i=(t.addClass(e.get_classes(" ")),this);this.get_status("render-init")||(this.set_status("render-init"),e.on("render-init",function(t){i.dom_put("layout",t.data)})),e.render(!0)},dom_prep:function(t){t=this.util.is_bool(t)&&!t?"removeClass":"addClass";l("html")[t](this.util.add_prefix("overlay"))},dom_restore:function(){this.dom_prep(!1)},get_layout:function(){return this.dom_get("layout",{put:{success:function(){l(this).hide()}}})},animation_enabled:function(){return this.get_attribute("animate",!0)},overlay_enabled:function(){var t=this.get_attribute("overlay_enabled");return!!this.util.is_bool(t)&&t},get_overlay:function(){var t=null,e=this;return this.overlay_enabled()&&(t=this.dom_get("overlay",{put:{success:function(){l(this).hide().css("opacity",e.get_attribute("overlay_opacity"))}}})),l(t)},unload:function(){var t=l.Deferred();return this.get_theme().dom_get_tag("item").text(""),t.resolve(),t.promise()},reset:function(){this.dom_get().hide(),this.dom_restore(),this.history_reset(),this.clear_item(),this.set_active(!1),this.set_loading(!1),this.slideshow_stop(),this.keys_disable(),this.unlock()},get_labels:function(){return this.get_attribute("labels",{})},get_label:function(t){var e=this.get_labels();return t in e?e[t]:""},events_open:function(){if(this.keys_enable(),this.open)return!1;function t(){i.close()}var e=this.get_layout(),i=(e.children().click(function(t){t.stopPropagation()}),this);e.click(t),this.get_overlay().click(t),this.trigger("events-open")},events_complete:function(){if(this.init)return!1;this.trigger("events-complete")},keys_enable:function(t){this.util.is_bool(t)||(t=!0);var e=["keyup",this.util.get_prefix()].join("."),i=this;t?l(document).on(e,function(t){return i.keys_control(t)}):l(document).off(e)},keys_disable:function(){this.keys_enable(!1)},keys_control:function(t){var e={27:this.close,37:this.item_prev,39:this.item_next};if("rtl"===document.documentElement.getAttribute("dir")&&(e[37]=this.item_next,e[39]=this.item_prev),t.which in e)return e[t.which].call(this),!1},slideshow_enabled:function(){var t=this.get_attribute("slideshow_enabled");return!(!(this.util.is_bool(t)&&t&&this.get_item())||this.get_item().get_group().is_single())},slideshow_active:function(){return!(!this.slideshow_enabled()||!(this.get_attribute("slideshow_active")||!this.init&&this.get_attribute("slideshow_autostart")))},slideshow_clear_timer:function(){clearInterval(this.get_attribute("slideshow_timer"))},slideshow_set_timer:function(t){this.set_attribute("slideshow_timer",setInterval(t,1e3*this.get_attribute("slideshow_duration")))},slideshow_start:function(){if(!this.slideshow_enabled())return!1;this.set_attribute("slideshow_active",!0),this.dom_get().addClass("slideshow_active"),this.slideshow_clear_timer();var t=this;this.slideshow_set_timer(function(){t.slideshow_pause(),t.item_next()}),this.trigger("slideshow-start")},slideshow_stop:function(t){(t=this.util.is_bool(t)?t:!0)&&(this.set_attribute("slideshow_active",!1),this.dom_get().removeClass("slideshow_active")),this.slideshow_clear_timer(),this.trigger("slideshow-stop")},slideshow_toggle:function(){if(!this.slideshow_enabled())return!1;this.slideshow_active()?this.slideshow_stop():this.slideshow_start(),this.trigger("slideshow-toggle")},slideshow_pause:function(t){this.util.is_bool(t)||(t=!0),this.slideshow_active()&&(t?this.slideshow_stop(!1):this.slideshow_start()),this.trigger("slideshow-pause")},slideshow_resume:function(){this.slideshow_pause(!1)},item_next:function(){var t=this.get_item().get_group(!0),e=this,i="item-next",s=["events","viewer",i].join("_");t.get_status(s)||(t.set_status(s),t.on(i,function(t){e.trigger(t.type)})),t.show_next()},item_prev:function(){var t=this.get_item().get_group(!0),e=this,i="item-prev",s=["events","viewer",i].join("_");t.get_status(s)||(t.set_status(s),t.on(i,function(){e.trigger(i)})),t.show_prev()},close:function(){this.set_active(!1);var t=this,e=this.get_theme();return e.transition("unload").always(function(){e.transition("close",!0).always(function(){t.reset(),t.trigger("close")})}).fail(function(){e.dom_get_tag("item","content").attr("style","")}),!1}}),e=(h.Viewer=t.extend(e),{_slug:"group",_reciprocal:!0,_refs:{current:"Content_Item"},current:null,selector:null,_hooks:function(){var t=this;this.on(["item-prev","item-next"],function(){t.trigger("item-change")})},get_selector:function(){return this.util.is_empty(this.selector)&&(this.selector=this.util.format('a[%s="%s"]',this.dom_get_attribute(),this.get_id())),this.selector},get_items:function(){var t=l(this.get_selector());return t=0===t.length&&this.has_current()?this.get_current().dom_get():t},get_item:function(t){this.util.is_int(t)||(t=0);var e=this.get_items(),i=this.get_size()-1;return e.get(t=i<t?i:t)},get_pos:function(t){return this.util.is_empty(t)&&(t=this.get_current()),this.util.is_type(t,h.Content_Item)?this.get_items().index(t.dom_get()):-1},has_current:function(){return!this.util.is_empty(this.get_current())},get_current:function(){return null===this.current||this.util.is_type(this.current,h.Content_Item)||(this.current=null),this.current},set_current:function(t){this.util.is_type(t,h.Content_Item)&&(this.current=t)},get_next:function(t){var e,i;return this.util.is_type(t,h.Content_Item)||(t=this.get_current()),1===this.get_size()?t:(e=null,-1===(i=this.get_pos(t))||0===(i=i+1<this.get_size()?i+1:0)&&!t.get_viewer().get_attribute("loop")?e:this.get_item(i))},get_prev:function(t){var e,i;return this.util.is_type(t,h.Content_Item)||(t=this.get_current()),1===this.get_size()?t:(e=null,-1===(i=this.get_pos(t))||0===i&&!t.get_viewer().get_attribute("loop")||(0===i&&(i=this.get_size()),e=this.get_item(--i)),e)},show_next:function(t){var e;1<this.get_size()&&((e=this.get_next(t))||(t=this.util.is_type(t,h.Content_Item)?t:this.get_current()).get_viewer().close(),t=this.get_controller().get_item(e),this.set_current(t),t.show(),this.trigger("item-next"))},show_prev:function(t){var e;1<this.get_size()&&((e=this.get_prev(t))||(t=this.util.is_type(t,h.Content_Item)?t:this.get_current()).get_viewer().close(),t=this.get_controller().get_item(e),this.set_current(t),t.show(),this.trigger("item-prev"))},get_size:function(){return this.get_items().length},is_single:function(){return 1===this.get_size()}}),e=(h.Group=t.extend(e),{_slug:"content_handler",_refs:{item:"Content_Item"},item:null,template:"",has_item:function(){return!this.util.is_empty(this.get_item())},get_item:function(){return this.get_component("item")},set_item:function(t){return this.set_component("item",t)},clear_item:function(){this.clear_component("item")},match:function(t){var e=this.get_attribute("match");if(!this.util.is_empty(e)){if(this.util.is_string(e)&&(e=new RegExp(e,"i"),this.set_attribute("match",e)),this.util.is_type(e,RegExp))return e.test(t.get_uri());if(this.util.is_func(e))return!!e.call(this,t)}return!1},load:function(t){var e=l.Deferred();return null===this.call_attribute("load",t,e)&&e.resolve(),e.promise()},render:function(t){var e=l.Deferred();return this.call_attribute("render",t,e),e.promise()}}),e=(h.Content_Handler=t.extend(e),{_slug:"content_item",_reciprocal:!0,_refs:{viewer:"Viewer",group:"Group",type:"Content_Handler"},_attr_default:{source:null,permalink:null,dimensions:null,title:"",group:null,internal:!1,output:null},group:null,viewer:null,type:null,data:null,loaded:null,_c:function(t){this.dom_set(t),this._super()},init_default_attributes:function(){this._super();var t,e,i=this.dom_get(),s=i.attr(this.util.get_attribute("asset"))||null,n=this.get_controller().assets||null;return this.util.is_string(s)&&(i=[{},this._attr_default,{permalink:i.attr("href")}],this.util.is_obj(n)&&(t=this,i.push((e={},e=(s=s)in n&&t.util.is_obj(n[s])?n[s]:e))),this._attr_default=l.extend.apply(this,i)),this._attr_default},get_output:function(){var e,i=l.Deferred(),t=this.get_attribute("output");return this.util.is_string(t)?i.resolve(t):this.has_type()?this.get_type().render(e=this).done(function(t){e.set_output(t),i.resolve(t)}):i.resolve(""),i.promise()},set_output:function(t){this.util.is_string(t,!1)&&this.set_attribute("output",t)},get_content:function(){return this.get_output()},get_uri:function(t){-1===l.inArray(t,["source","permalink"])&&(t="source");var e=this.get_attribute(t);return e=(e=this.util.is_string(e)?e:"source"===t?this.get_attribute("permalink"):"").replace(/&(#38|amp);/,"&")},get_title:function(){var t="title_cached";if(this.has_attribute(t))return this.get_attribute(t,"");function e(t){return"string"!=typeof t||""===t.trim()?"":(t=t.trim(),n.get_viewer().get_attribute("title_default")||t===n.get_title_default()&&(t=""),t)}var i="",s=this.dom_get(),n=this;if(!(i=s.length?(i=(i=(i=s.attr("title"))||e(s.find("img").first().attr("alt")))||s.closest("figure").find("figcaption").first().html())||s.closest("figure").find(".wp-caption-text").first().html():i))for(var r=["caption","title"],_=0;_<r.length&&(i=e(this.get_attribute(r[_],"")),this.util.is_empty(i));_++);return!i&&s.length&&(i=e(s.get(0).innerText.trim()),i=this.util.esc_html(i)),i=e(i),this.set_attribute(t,i),i},get_title_default:function(){var t,e,i="title_default";return this.has_attribute(i)?this.get_attribute(i):(-1!==(e=(t=this.get_uri("source")).lastIndexOf("/"))&&-1!==(e=(t=t.substr(e+1)).lastIndexOf("."))&&(t=t.substr(0,e)),this.set_attribute(i,t))},get_dimensions:function(){return l.extend({width:0,height:0},this.get_attribute("dimensions"),{})},set_data:function(t){this.data=t},get_data:function(){return this.data},gallery_type:function(){var t,e=null,i={wp:".gallery-icon",ngg:".ngg-gallery-thumbnail"},s=this.dom_get();for(t in i)if(0<s.parent(i[t]).length){e=t;break}return e},in_gallery:function(t){var e=this.gallery_type();return null!==e&&(!this.util.is_string(t)||t===e)},get_viewer:function(){return this.get_component("viewer",{get_default:!0})},set_viewer:function(t){return this.set_component("viewer",t)},get_group:function(t){var e=this.get_component("group");return e||(e=this.set_component("group",new h.Group),t=!0),t&&e.set_current(this),e},set_group:function(t){this.util.is_string(t)&&(t=this.get_controller().get_group(t)),this.group=!!this.util.is_type(t,h.Group)&&t},get_type:function(){return this.get_component("type",{check_attr:!1})||this.set_type(this.get_controller().get_content_handler(this))},set_type:function(t){return this.set_component("type",t)},has_type:function(){return!this.util.is_empty(this.get_type())},show:function(t){if(!this.has_type())return!1;this.set_attribute("options_show",t);t=this.get_viewer();return this.load(),t.show(this)},load:function(){return this.util.is_promise(this.loaded)||(this.loaded=this.get_type().load(this)),this.loaded.promise()},reset:function(){this.set_attribute("options_show",null)}}),e=(h.Content_Item=t.extend(e),{_slug:"modeled_component",get_attribute:function(t,e,i,s){var n;return!this.util.is_string(t)||(n=null)===(n=(i=this.util.is_bool(i)?i:!0)&&(i=this.get_ancestor(t,!1),this.util.in_obj(i,t))?i[t]:n)?this._super(t,e,s):n},get_attribute_recursive:function(i,t,e){var s,n=this.get_attribute(i,t,!0,e);return this.util.is_obj(n)&&(t=this.get_ancestors(!1),n=[n],s=this,l.each(t,function(t,e){i in e&&s.util.is_obj(e[i])&&n.push(e[i])}),n.push({}),n=l.extend.apply(l,n.reverse())),n},set_attribute:function(t,e,i){return!(!this.util.is_string(t)||!this.util.is_set(e))&&((i=this.util.is_bool(i)||this.util.is_obj(i)?i:!0)?(this.util.is_obj(i)?i:this.get_model())[t]=e:this._super(t,e),e)},get_model:function(){var t=this.get_attribute("model",null,!1);return this.util.is_obj(t)||this.set_attribute("model",t={},!1),t},has_model:function(){return!this.util.is_empty(this.get_model())},in_model:function(t){return!!this.util.in_obj(this.get_model(),t)},get_ancestors:function(t){for(var e=[],i=this.get_model();this.util.is_obj(i);)e.push(i),i=this.util.in_obj(i,"parent")&&this.util.is_obj(i.parent)?i.parent:null;return t||e.shift(),e},get_ancestor:function(t,e){if(!this.util.is_string(t))return!1;this.util.is_bool(e)||(e=!0);for(var i=this.get_model(),s=i,n=!1;this.util.is_obj(s);){if(this.util.in_obj(s,t)&&!this.util.is_empty(s[t])){n=!0;break}s=this.util.in_obj(s,"parent")?s.parent:null}return n||(e?(this.util.is_empty(s)&&(s=i),this.util.in_obj(s,t)||(s[t]=null)):s=null),s}}),e=t.extend(e),i=(h.Theme=e.extend({_slug:"theme",_refs:{viewer:"Viewer",template:"Template"},_models:{},_attr_default:{template:null,model:null},viewer:null,template:null,_c:function(t,e,i){1===arguments.length&&this.util.is_type(arguments[0],h.Viewer)&&(i=arguments[0],t=null),this._super(t,e),this.set_viewer(i),this.set_model(t)},get_viewer:function(){return this.get_component("viewer",{check_attr:!1,get_default:!0})},set_viewer:function(t){return this.set_component("viewer",t)},get_template:function(){var t,e=this.get_component("template");return this.util.is_empty(e)&&(t={theme:this,model:this.get_model()},e=this.set_component("template",new h.Template(t))),e},get_tags:function(t,e){return this.get_template().get_tags(t,e)},dom_get_tag:function(t,e){return l(this.get_template().dom_get_tag(t,e))},get_tag_selector:function(t,e){return this.get_template().get_tag_selector(t,e)},get_models:function(){return this._models},get_model:function(t){var e;return!this.util.is_set(t)&&this.util.is_obj(this.get_attribute("model",null,!1))?this._super():(e=this.get_models(),this.util.is_string(t)||(t=this.get_controller().get_option("theme_default")),e[t=this.util.in_obj(e,t)?t:l.map(e,function(t,e){return e})[0]])},set_model:function(t){this.set_attribute("model",this.get_model(t),!1)},get_classes:function(t){var i=[],s=this,e=this.get_ancestors(!0);return l.each(e,function(t,e){i.push(s.add_ns(e.id))}),i=this.util.is_string(t)?i.join(t):i},get_measurement:function(t,e){var i=null;if(!this.util.is_string(t))return i;this.util.is_obj(e,!1)||(e={});var s=this.util.format("%s_cache",t),n=this.get_attribute(s,{},!1),r="_status",_=this.get_viewer().get_item(),o=l(window),o=(r in n&&this.util.is_obj(n[r])&&n[r].width===o.width()&&n[r].height===o.height()||(n={}),this.util.is_empty(n)&&(n[r]={width:o.width(),height:o.height(),index:[]}),l.inArray(_,n[r].index));return-1!==o&&o in n&&(i=n[o]),this.util.is_obj(i)||(i=this.call_attribute(t),this.util.is_obj(i))||(i=this.get_measurement_default(t)),i=this.util.is_obj(i)?l.extend({},e,i):e,o=n[r].index.push(_)-1,n[o]=i,this.set_attribute(s,n,!1),l.extend({},i)},get_measurement_default:function(t){return this.util.is_string(t)?(t=this.util.format("get_%s_default",t),this.util.in_obj(this,t)?(t=this[t],this.util.is_func(t)&&(t=t.call(this))):t=null,t):null},get_offset:function(){return this.get_measurement("offset",{width:0,height:0})},get_offset_default:function(){var t,i={width:0,height:0},e=this.get_viewer(),s=e.dom_get(),s=s.clone().attr("id","").css({visibility:"hidden",position:"absolute",top:""}).removeClass("loading").appendTo(s.parent()),n=s.find(e.dom_get_selector("layout"));return n.length&&(n.find("*").css({width:"",height:"",display:""}),(t=this.get_tags("item","content")).length&&(e=e.get_item().get_dimensions(),t=l(n.find(t[0].get_selector("full")).get(0)).css({width:e.width,height:e.height}),l.each(e,function(t,e){i[t]=-1*e})),i.width+=n.width(),i.height+=n.height(),l.each(i,function(t,e){e<0&&(i[t]=0)})),s.empty().remove(),i},get_margin:function(){return this.get_measurement("margin",{width:0,height:0})},get_item_dimensions:function(){var t,e,i=this.get_viewer(),s=i.get_item().get_dimensions();return i.get_attribute("autofit",!1)&&(i=this.get_margin(),(t=this.get_offset()).height+=i.height,t.width+=i.width,(i={width:l(window).width(),height:l(window).height()}).width>t.width&&(i.width-=t.width),i.height>t.height&&(i.height-=t.height),(e=Math.min(i.width/s.width,i.height/s.height))<1)&&l.each(s,function(t){s[t]=Math.round(s[t]*e)}),l.extend({},s)},get_dimensions:function(){var e=this.get_item_dimensions(),i=this.get_offset();return l.each(e,function(t){e[t]+=i[t]}),e},get_breakpoints:function(){return this.get_attribute_recursive("breakpoints")},get_breakpoint:function(t){var e,i=0;return i=this.util.is_string(t)&&(e=this.get_attribute_recursive("breakpoints"),this.util.is_obj(e))&&t in e?e[t]:i},render:function(t){var e=this,i=this.get_template(),s="events_render";this.get_status(s)||(this.set_status(s),i.on(["render-init","render-loading","render-complete"],function(t){return e.trigger(t.type,t.data)})),i.render(t)},transition:function(t,e){var i,s,n,r=null,_="transition",o=this.get_viewer(),u=null,h=o.animation_enabled();return o.get_attribute(_,!0)&&this.util.is_string(t)&&(e&&o.get_layout().find("*").each(function(){for(var t=l(this);t.queue().length;)t.stop(!1,!0)}),e=[_,"set"].join("_"),s=this.get_attribute(e)?this.get_attribute(_,{}):(i=this.get_ancestors(!0),s=[],this.set_attribute(e,!0),n=this,l.each(i,function(t,e){_ in e&&n.util.is_obj(e[_])&&s.push(e[_])}),s.push({}),this.set_attribute(_,l.extend.apply(l,s.reverse()))),this.util.is_method(s,t))&&(h||(u=l.fx.off,l.fx.off=!0),r=s[t].call(this,o,l.Deferred())),this.util.is_promise(r)||(r=l.Deferred()).reject(),r.always(function(){null!==u&&(l.fx.off=u)}),r.promise()}}),{_slug:"template",_reciprocal:!0,_refs:{theme:"Theme"},_attr_default:{layout_uri:"",layout_raw:"",layout_parsed:"",tags:null,model:null},theme:null,_c:function(t){this._super("",t)},_hooks:function(){this.on("dom_init",function(s){var t=this.get_tags(null,null,!0),n=[],r=this;l.each(t,function(t,e){var i=e.get_name();-1===l.inArray(i,n)&&(n.push(i),e.get_handler().trigger(s.type,{template:r}))})})},get_theme:function(){return this.get_component("theme")},render:function(t){var i,e,s,n,r=this.get_theme().get_viewer();if(!(t=this.util.is_bool(t)?t:!1))return!!r.is_active()&&(i=r.get_item(),this.util.is_type(i,h.Content_Item)?void(r.is_active()&&this.has_tags()&&(t=this.trigger("render-loading"),s=(e=this).get_tags(),n=[],l.when(i.load(),t).done(function(){return!!r.is_active()&&(l.each(s,function(t,e){if(!r.is_active())return!1;n.push(e.render(i).done(function(t){if(!r.is_active())return!1;t.tag.dom_get().html(t.output)}))}),!!r.is_active())&&void l.when.apply(l,n).done(function(){e.trigger("render-complete")})}))):(r.close(),!1));this.trigger("render-init",this.dom_get())},get_layout:function(t){return(t=this.util.is_bool(t)?t:!0)?this.parse_layout():this.get_attribute("layout_raw","")},parse_layout:function(){var t="layout_parsed",e=this.get_attribute(t);return this.util.is_string(e)||(e=this.sanitize_layout(this.get_layout(!1)),e=this.parse_tags(e),this.set_attribute(t,e)),e},sanitize_layout:function(t){var e,i,s,n,r;return this.util.is_empty(t)||(e=this.util.is_string(t)?"string":null,i=l(t),s=this.get_tag_temp(),n=s.get_class(),r=["x",n].join("_"),l(s.get_selector(),i).each(function(){l(this).removeClass(n).addClass(r)}),t="string"===e?i=i.wrap("<div />").parent().html():i),t},parse_tags:function(t){if(!this.util.is_string(t))return"";for(var e,i=/\{{2}\s*(\w.*?)\s*\}{2}/gim;e=i.exec(t);)t=t.substring(0,e.index)+this.get_tag_container(e[1])+t.substring(e.index+e[0].length);return t},get_tag_container:function(t){var e=this.get_tag_attribute();return this.util.format('<span %s="%s"></span>',e,encodeURI(t))},get_tag_attribute:function(){return this.get_tag_temp().dom_get_attribute()},get_tag:function(t){var e,i=null;return i=this.has_tags()?(e=this.get_tags())[t=!this.util.is_int(t)||t<0||t>=e.length?0:t]:i},get_tags:function(t,e,i){this.util.is_bool(i)||(i=!1);var s,n,r=this.get_attribute("tags");if(this.util.is_array(r)||(r=[],n=this.dom_get(),s=this.get_tag_attribute(),n=l(n).find("["+s+"]"),l(n).each(function(){var t=l(this),e=new h.Template_Tag(decodeURI(t.attr(s)));e.has_handler()&&(r.push(e),i||(e.dom_set(t),t.addClass(e.get_classes(" ")))),i||t.removeAttr(s)}),i)||this.set_attribute("tags",r,!1),!this.util.is_empty(r)&&this.util.is_string(t)){this.util.is_string(e)||(e=!1);for(var _=[],o=null,u=0;u<r.length;u++)t!==(o=r[u]).get_name()||e&&e!==o.get_prop()||_.push(o);r=_}return this.util.is_array(r,!1)?r:[]},has_tags:function(){return 0<this.get_tags().length},get_tag_temp:function(){return this.get_controller().get_component_temp(h.Template_Tag)},get_tag_selector:function(t,e){this.util.is_string(t)||(t=""),this.util.is_string(e)||(e="");var i=this.get_tag_temp();return i.set_attribute("name",t),i.set_attribute("prop",e),i.get_selector("full")},dom_init:function(){this.dom_set(this.get_layout()),this.trigger("dom_init")},dom_get_tag:function(t,e){var i,s=l(),n=this.get_tags(t,e);return n.length&&(i=null,this.util.is_string(t)&&(i=this.util.is_string(e)?"full":"tag"),t="."+n[0].get_class(i),s=this.dom_get().find(t)),s}}),e=(h.Template=e.extend(i),{_slug:"template_tag",_reciprocal:!0,_attr_default:{name:null,prop:null,match:null},handlers:{},_c:function(t){this.parse(t)},parse:function(t){if(!this.util.is_string(t))return!1;var e,i=t.split("|");if(!i.length)return null;var s={name:null,prop:null,match:t};s.name=i[0],-1!==s.name.indexOf(".")&&(s.name=s.name.split(".",2),s.prop=s.name[1],s.name=s.name[0]);for(var n=1;n<i.length;n++)1<(e=i[n].split(":",1)).length&&!(e[0]in s)&&(s[e[0]]=e[1]);this.set_attributes(s,!0)},render:function(t){var e=this;return e.get_handler().render(t,e).pipe(function(t){return{tag:e,output:t}})},get_name:function(){return this.get_attribute("name")},get_prop:function(){return this.get_attribute("prop")},get_handler:function(){return this.has_handler()?this.handlers[this.get_name()]:new h.Template_Tag_Handler("")},has_handler:function(){return this.get_name()in this.handlers},get_classes:function(t){var e=[this.get_class(),this.get_class("tag"),this.get_class("full")];return e=this.util.is_string(t)?e.join(t):e},get_class:function(t){var e="";switch(t){case"tag":e=this.get_name();break;case"full":for(var i=[this.get_name(),this.get_prop()],s=[],n=0;n<i.length;n++)this.util.is_string(i[n])&&s.push(i[n]);e=s.join("_")}return this.util.is_string(e)?this.add_ns(e):this.get_ns()},get_selector:function(t){t=this.get_class(t);return t=this.util.is_string(t)?"."+t:""}}),i=(h.Template_Tag=t.extend(e),{_slug:"template_tag_handler",_attr_default:{supports_modifiers:!1,dynamic:!1,props:{}},render:function(t,e){var i=l.Deferred();return this.call_attribute("render",t,e,i),i.promise()},add_prop:function(t,e){var i=this.get_attribute("props");if(!this.util.is_string(t)||!this.util.is_func(e))return!1;(i=this.util.is_obj(i,!1)?i:{})[t]=e,this.set_attribute("props",i)},handle_prop:function(t,e,i){var s=this.get_attribute("props");return this.util.is_obj(s)&&t in s&&this.util.is_func(s[t])?s[t].call(this,e,i):e.get_viewer().get_label(t)}});h.Template_Tag_Handler=t.extend(i),h=SLB.attach("View",h)})(jQuery);
